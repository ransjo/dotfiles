#!/bin/bash
date >> /tmp/funlog
MAX_TEMP=65000
FLAG_FILE=/tmp/
DIR=/sys/bus/platform/devices/coretemp.0/hwmon/hwmon2
TEMP1=$(cat $DIR/temp1_input)
TEMP2=$(cat $DIR/temp2_input)
TEMP3=$(cat $DIR/temp3_input)

MIN_TEMP=48
MAX="$TEMP1"

if [[ "$TEMP2" > "$MAX" ]]
then
    MAX="$TEMP2"
fi

if [[ "$TEMP3" > "$MAX" ]]
then
   MAX="$TEMP3"
fi

echo "gurka" >> /tmp/funlog
if (($MAX <= $MIN_TEMP))
then
    echo "nils" >> /tmp/funlog
    DRI_PRIME=1 glxinfo > /dev/null
    rm /tmp/funflag
fi

if [ -f /tmp/funflag ]
then
    exit
fi

if [[ "$MAX" > "$MAX_TEMP" ]]
then
    xrandr --setprovideroffloadsink 0x55 0x7d
    DRI_PRIME=1 glxinfo > /dev/null
    touch /tmp/funflag
fi
